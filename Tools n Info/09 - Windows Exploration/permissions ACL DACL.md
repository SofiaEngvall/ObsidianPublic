
from: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-mask-format

![[Images/accctrl4.png]]

In this format, the low-order 16 bits are for object-specific access rights, the next 8 bits are for [standard access rights](https://learn.microsoft.com/en-us/windows/win32/secauthz/standard-access-rights), which apply to most types of objects, and the 4 high-order bits are used to specify [generic access rights](https://learn.microsoft.com/en-us/windows/win32/secauthz/generic-access-rights) that each object type can map to a set of standard and object-specific rights. The ACCESS_SYSTEM_SECURITY bit corresponds to the [right to access the object's SACL](https://learn.microsoft.com/en-us/windows/win32/secauthz/sacl-access-right).

Each type of securable object has a set of access rights that correspond to operations specific to that type of object. In addition to these object-specific access rights, there is a set of standard access rights that correspond to operations common to most types of securable objects.

Securable objects use an access mask format in which the four high-order bits specify generic access rights. Each type of securable object maps these bits to a set of its standard and object-specific access rights.

### Generic Access Rights Constants
---

| Constant                  | Value        | Generic meaning            |
| ------------------------- | ------------ | -------------------------- |
| **GENERIC_ALL**  <br>     | `0x10000000` | All possible access rights |
| **GENERIC_EXECUTE**  <br> | `0x20000000` | Execute access             |
| **GENERIC_WRITE**  <br>   | `0x40000000` | Write access               |
| **GENERIC_READ**  <br>    | `0x80000000` | Read access                |

### Standard Access Rights Constants
---
Standard access (defined in Winnt.h)

| Constant     | Meaning                                                                                                                                                                                                                                                                                    |
| ------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| DELETE       | The right to delete the object.                                                                                                                                                                                                                                                            |
| READ_CONTROL | The right to read the information in the object's [_security descriptor_](https://learn.microsoft.com/en-us/windows/desktop/SecGloss/s-gly), not including the information in the [_system access control list_](https://learn.microsoft.com/en-us/windows/desktop/SecGloss/s-gly) (SACL). |
| SYNCHRONIZE  | The right to use the object for synchronization. This enables a thread to wait until the object is in the signaled state. Some object types do not support this access right.                                                                                                              |
| WRITE_DAC    | The right to modify the [_discretionary access control list_](https://learn.microsoft.com/en-us/windows/desktop/SecGloss/d-gly) (DACL) in the object's security descriptor.                                                                                                                |
| WRITE_OWNER  | The right to change the owner in the object's security descriptor.                                                                                                                                                                                                                         |

Combinations of the standard access rights constants (Winnt.h)

| Constant                 | Meaning                                                                        |
| ------------------------ | ------------------------------------------------------------------------------ |
| STANDARD_RIGHTS_ALL      | Combines DELETE, READ_CONTROL, WRITE_DAC, WRITE_OWNER, and SYNCHRONIZE access. |
| STANDARD_RIGHTS_EXECUTE  | Currently defined to equal READ_CONTROL.                                       |
| STANDARD_RIGHTS_READ     | Currently defined to equal READ_CONTROL.                                       |
| STANDARD_RIGHTS_REQUIRED | Combines DELETE, READ_CONTROL, WRITE_DAC, and WRITE_OWNER access.              |
| STANDARD_RIGHTS_WRITE    | Currently defined to equal READ_CONTROL.                                       |

### Service Access Rights Constants

The Windows security model enables you to control access to the [service control manager](https://learn.microsoft.com/en-us/windows/win32/services/service-security-and-access-rights) (SCM) and service objects. Here we only list the service object ones.

| Access right                              | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ----------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SERVICE_ALL_ACCESS** (0xF01FF)          | Includes **STANDARD_RIGHTS_REQUIRED** in addition to all access rights in this table.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **SERVICE_CHANGE_CONFIG** (0x0002)        | Required to call the [**ChangeServiceConfig**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfiga) or [**ChangeServiceConfig2**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-changeserviceconfig2a) function to change the service configuration. Because this grants the caller the right to change the executable file that the system runs, it should be granted only to administrators.                                                                                                               |
| **SERVICE_ENUMERATE_DEPENDENTS** (0x0008) | Required to call the [**EnumDependentServices**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-enumdependentservicesa) function to enumerate all the services dependent on the service.                                                                                                                                                                                                                                                                                                                                                              |
| **SERVICE_INTERROGATE** (0x0080)          | Required to call the [**ControlService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-controlservice) function to ask the service to report its status immediately.                                                                                                                                                                                                                                                                                                                                                                                |
| **SERVICE_PAUSE_CONTINUE** (0x0040)       | Required to call the [**ControlService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-controlservice) function to pause or continue the service.                                                                                                                                                                                                                                                                                                                                                                                                   |
| **SERVICE_QUERY_CONFIG** (0x0001)         | Required to call the [**QueryServiceConfig**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-queryserviceconfiga) and [**QueryServiceConfig2**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-queryserviceconfig2a) functions to query the service configuration.                                                                                                                                                                                                                                                            |
| **SERVICE_QUERY_STATUS** (0x0004)         | Required to call the [**QueryServiceStatus**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatus) or [**QueryServiceStatusEx**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-queryservicestatusex) function to ask the service control manager about the status of the service.  <br>Required to call the [**NotifyServiceStatusChange**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-notifyservicestatuschangea) function to receive notification when a service changes status. |
| **SERVICE_START** (0x0010)                | Required to call the [**StartService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-startservicea) function to start the service.                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **SERVICE_STOP** (0x0020)                 | Required to call the [**ControlService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-controlservice) function to stop the service.                                                                                                                                                                                                                                                                                                                                                                                                                |
| **SERVICE_USER_DEFINED_CONTROL**(0x0100)  | Required to call the [**ControlService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-controlservice) function to specify a user-defined control code.                                                                                                                                                                                                                                                                                                                                                                                             |

The following are the [standard access rights](https://learn.microsoft.com/en-us/windows/desktop/SecAuthZ/standard-access-rights) for a service.

| Access right               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| -------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ACCESS_SYSTEM_SECURITY** | Required to call the [**QueryServiceObjectSecurity**](https://learn.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-queryserviceobjectsecurity) or [**SetServiceObjectSecurity**](https://learn.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) function to access the SACL. The proper way to obtain this access is to enable the **SE_SECURITY_NAME**[**privilege**](https://learn.microsoft.com/en-us/windows/desktop/SecAuthZ/privileges) in the caller's current access token, open the handle for **ACCESS_SYSTEM_SECURITY** access, and then disable the privilege. |
| **DELETE** (0x10000)       | Required to call the [**DeleteService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-deleteservice) function to delete the service.                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **READ_CONTROL** (0x20000) | Required to call the [**QueryServiceObjectSecurity**](https://learn.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-queryserviceobjectsecurity) function to query the security descriptor of the service object.                                                                                                                                                                                                                                                                                                                                                                                              |
| **WRITE_DAC** (0x40000)    | Required to call the [**SetServiceObjectSecurity**](https://learn.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) function to modify the **Dacl** member of the service object's security descriptor.                                                                                                                                                                                                                                                                                                                                                                               |
| **WRITE_OWNER** (0x80000)  | Required to call the [**SetServiceObjectSecurity**](https://learn.microsoft.com/en-us/windows/desktop/api/winsvc/nf-winsvc-setserviceobjectsecurity) function to modify the **Owner** and **Group** members of the service object's security descriptor.                                                                                                                                                                                                                                                                                                                                                               |

The following are the [generic access rights](https://learn.microsoft.com/en-us/windows/desktop/SecAuthZ/generic-access-rights) for a service.

| Access right        | Description                                                                                                                                             |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GENERIC_READ**    | **STANDARD_RIGHTS_READ**  <br>**SERVICE_QUERY_CONFIG**  <br>**SERVICE_QUERY_STATUS**  <br>**SERVICE_INTERROGATE**  <br>**SERVICE_ENUMERATE_DEPENDENTS** |
| **GENERIC_WRITE**   | **STANDARD_RIGHTS_WRITE**  <br>**SERVICE_CHANGE_CONFIG**                                                                                                |
| **GENERIC_EXECUTE** | **STANDARD_RIGHTS_EXECUTE**  <br>**SERVICE_START**  <br>**SERVICE_STOP**  <br>**SERVICE_PAUSE_CONTINUE**  <br>**SERVICE_USER_DEFINED_CONTROL**          |

The SCM creates a service object's security descriptor when the service is installed by the [**CreateService**](https://learn.microsoft.com/en-us/windows/desktop/api/Winsvc/nf-winsvc-createservicea) function. The default security descriptor of a service object grants the following access.

|Account|Access rights|
|---|---|
|Remote authenticated users|Not granted by default.**Windows Server 2003 with SP1: SERVICE_USER_DEFINED_CONTROL**  <br>**Windows Server 2003 and Windows XP:** The access rights for remote authenticated users are the same as for local authenticated users.|
|Local authenticated users (including LocalService and NetworkService)|**READ_CONTROL**  <br>**SERVICE_ENUMERATE_DEPENDENTS**  <br>**SERVICE_INTERROGATE**  <br>**SERVICE_QUERY_CONFIG**  <br>**SERVICE_QUERY_STATUS**  <br>**SERVICE_USER_DEFINED_CONTROL**|
|LocalSystem|**READ_CONTROL**  <br>**SERVICE_ENUMERATE_DEPENDENTS**  <br>**SERVICE_INTERROGATE**  <br>**SERVICE_PAUSE_CONTINUE**  <br>**SERVICE_QUERY_CONFIG**  <br>**SERVICE_QUERY_STATUS**  <br>**SERVICE_START**  <br>**SERVICE_STOP**  <br>**SERVICE_USER_DEFINED_CONTROL**|
|Administrators|**DELETE**  <br>**READ_CONTROL**  <br>**SERVICE_ALL_ACCESS**  <br>**WRITE_DAC**  <br>**WRITE_OWNER**|
